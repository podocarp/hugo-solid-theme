{{ $opts := (.Get "opts") }}
{{ if not $opts }}
{{ $opts = "" }}
{{ end }}

{{ $lang := (.Get "lang") }}
{{ if not $lang}}
{{ $lang = "bash" }}
{{ end }}

{{ $header := (.Get "path") }}
{{ $header = (printf
  "<pre class='chroma'><div class='filename'><strong>%s</strong></div>"
  $header) }}

{{ $res := highlight (trim .Inner "\n") $lang $opts }}
{{ $res = replace $res "<pre class=\"chroma\">" $header }}

{{ safeHTML $res }}
